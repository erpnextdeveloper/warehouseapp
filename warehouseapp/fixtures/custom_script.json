[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2017-07-19 15:54:43.263253", 
  "name": "Sales Order-Client", 
  "script": "cur_frm.add_fetch(\"customer\", \"warehouse\", \"warehouse\");\n\nfrappe.ui.form.on(\"Sales Order\",\"validate\", function(){\nfor (var i =0; i < cur_frm.doc.items.length; i++){\ncur_frm.doc.items[i].warehouse = cur_frm.doc.warehouse\n}\ncur_frm.refresh_field('items')\n});\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Delivery Note", 
  "modified": "2019-01-07 19:09:56.964013", 
  "name": "Delivery Note-Client", 
  "script": "frappe.ui.form.on(\"Delivery Note\", \"refresh\", function(frm, cdt, cdn) {\n    // code for calculate total and set on parent field.\n    total_qty = 0;\n    $.each(frm.doc.items || [], function(i, d) {\n    total_qty += flt(d.qty);\n    });\n    frm.set_value(\"total_qty\", total_qty);\n    });\n\n\nfrappe.ui.form.on(\"Delivery Note\", \"packing_slip_no\", function(frm, cdt, cdn) {\n\tif(frm.doc.packing_slip_no){\n\tfrappe.call({\n           method: \"frappe.client.get\",\n            args: {\n                name: frm.doc.packing_slip_no,\n                doctype: \"Packing Slips\"\n            },\n            callback(r) {\n                if (r.message) {\n\t\t\tif(r.message.customer!=frm.doc.customer){\n\t\t\tfrm.doc.packing_slip_no='';\n\t\t\trefresh_field(\"packing_slip_no\");\n\t\t\tfrappe.throw(\"Packing Slip Customer Is Different\")\n\t\t\t}\n\t\t\tif(parseInt(r.message.is_delivery_note)\t==1){\n\t\t\tfrm.doc.packing_slip_no='';\n\t\t\trefresh_field(\"packing_slip_no\");\n\t\t\t\tfrappe.throw(\"Already Scanned\")\n\n\t\t\t}\n                    for (var row in r.message.items) {\n\t\t\tconsole.log(row);\n                        var child = frm.add_child(\"items\");\n                        frappe.model.set_value(child.doctype, child.name, \"item_code\", r.message.items[row].item_code);\n\t\t\t frappe.model.set_value(child.doctype, child.name, \"qty\", r.message.items[row].qty);\n\t\t\tfrappe.model.set_value(child.doctype, child.name, \"warehouse\", r.message.warehouse)\n                        refresh_field(\"items\");\n\t\t\tfrm.doc.packing_slip_no='';\n\t\t\trefresh_field(\"packing_slip_no\");\n      \t\t\t  frappe.call({\n        \t\t\t    \"method\": \"warehouseapp.api.updatePackingSlip\",\n            \t\t\t    \"args\": {\n                                    \"name\":r.message.name\n                                     },\n\t\t\t\t    callback:function(res){\n\t\t\t\t\t}\n                               });\n                    }\n\n                }\n            }\n\n        })\n\t}\n    });\n\nfrappe.ui.form.on(\"Delivery Note\", \"item_barcode\", function(frm, cdt, cdn) {\n\t\t\tvar item = locals[cdt][cdn];\n\t\t\tconsole.log(item);\n\t\t\tif(frm.doc.__islocal) { \n\t\t\t\t\t\tfrm.doc.items=[]\n\t\t\t\t\t\tconsole.log(\"test\");\n\t\t\t\t\t\trefresh_field(\"items\");\n\t\t\t\t\t\tcur_frm.save()\n\t\t\n\t\t\t}\n\t\t\tvar flag=0\n\t\t\tfor(var row in item.items)\n\t\t\t{\n\t\t\t\tconsole.log(frm.doc.items[row].item_code);\n\t\t\t\tif(frm.doc.items[row].item_code==item.item_barcode)\n\t\t\t\t{\n\t\t\tfrm.doc.items[row].qty=parseInt(frm.doc.items[row].qty)+1\n\t\t\t\t\trefresh_field(\"items\");\t\t\n\n\t\t\t\t\tfrm.doc.item_barcode='';\n\t\t\t\t\trefresh_field(\"item_barcode\");\n\t\t\t\t\tcur_frm.save();\n\t\t\t\t\t//frappe.model.set_value(cdt,cdn,\"barcode\",frm.doc.name)\n\t\t\t\t\t//refresh_field(\"barcode\");\n\t\t\t\t\tflag=1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\tif(flag==0)\n\t\t\t{\n                        var child = frm.add_child(\"items\");\n\n                        frappe.model.set_value(child.doctype, child.name, \"item_code\",item.item_barcode);\n                        frappe.model.set_value(child.doctype, child.name, \"qty\",1);\n\t\t\trefresh_field(\"items\");\n\n\t\t\tfrm.doc.item_barcode='';\n\t\t\trefresh_field(\"item_barcode\");\n\t\t\tcur_frm.save();\n\n\t\t\t\t\t//frappe.model.set_value(cdt,cdn,\"barcode\",frm.doc.name)\n\t\t\t\t\t//refresh_field(\"barcode\");\n\n\t\t\t}\n});\n\n\n\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Payment Entry", 
  "modified": "2018-08-02 15:14:28.290488", 
  "name": "Payment Entry-Client", 
  "script": "frappe.ui.form.on(\"Payment Entry\", \"party\", function(frm, cdt, cdn) {\n\tif(frm.doc.party_type==\"Customer\")\n\t{\n\t\tfrappe.model.set_value(cdt,cdn,\"customer\",frm.doc.party)\n\t\trefresh_field(\"customer\")\n\t}\n    });\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Packing Slips", 
  "modified": "2018-10-03 00:32:51.550882", 
  "name": "Packing Slips-Client", 
  "script": "frappe.ui.form.on(\"Packing Slips\", \"item_barcode\", function(frm, cdt, cdn) {\n\t\t\tvar item = locals[cdt][cdn];\n\t\t\tconsole.log(item);\n\t\t\tif(frm.doc.__islocal) { \n\t\t\t\t\t\tfrm.doc.items=[]\n\t\t\t\t\t\tconsole.log(\"test\");\n\t\t\t\t\t\trefresh_field(\"items\");\n\t\t\t\t\t\tcur_frm.save()\n\t\t\n\t\t\t}\n\t\t\tvar flag=0\n\t\t\tfor(var row in item.items)\n\t\t\t{\n\t\t\t\tconsole.log(frm.doc.items[row].item_code);\n\t\t\t\tif(frm.doc.items[row].item_code==item.item_barcode)\n\t\t\t\t{\n\t\t\tfrm.doc.items[row].qty=parseInt(frm.doc.items[row].qty)+1\n\t\t\t\t\trefresh_field(\"items\");\t\t\n\n\t\t\t\t\tfrm.doc.item_barcode='';\n\t\t\t\t\trefresh_field(\"item_barcode\");\n\t\t\t\t\tcur_frm.save();\n\t\t\t\t\t//frappe.model.set_value(cdt,cdn,\"barcode\",frm.doc.name)\n\t\t\t\t\t//refresh_field(\"barcode\");\n\t\t\t\t\tflag=1;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\tif(flag==0)\n\t\t\t{\n                        var child = frm.add_child(\"items\");\n\n                        frappe.model.set_value(child.doctype, child.name, \"item_code\",item.item_barcode);\n                        frappe.model.set_value(child.doctype, child.name, \"qty\",1);\n\t\t\trefresh_field(\"items\");\n\n\t\t\tfrm.doc.item_barcode='';\n\t\t\trefresh_field(\"item_barcode\");\n\t\t\tcur_frm.save();\n\n\t\t\t\t\t//frappe.model.set_value(cdt,cdn,\"barcode\",frm.doc.name)\n\t\t\t\t\t//refresh_field(\"barcode\");\n\n\t\t\t}\n});\n\n\n\n\nfrappe.ui.form.on(\"Packing Slips\", \"on_submit\", function(frm, cdt, cdn) {\n\t\tconsole.log(frm.doc.name)\n\t             var w = window.open(frappe.urllib.get_full_url(\"/printview?\" +\n                    \"doctype=\" +\"Packing Slips\"+\n                    \"&name=\" +frm.doc.name+\n                    \"&trigger_print=1\" +\n                    \"&format=\"+\"barcode print\"+\n                    \"&no_letterhead=0\" +\n                    (me.lang_code ? (\"&_lang=\" + me.lang_code) : \"\")));\n\n                if (!w) {\n                    msgprint(__(\"Please enable pop-ups for printing.\"));\n                    return;\n                }\n\t\tw.print();\n\t\t\t\n});\n\n\nfrappe.ui.form.on(\"Packing Slips\", \"warehouse\", function(frm, cdt, cdn) {\n\t\t\n\tif(!frm.doc.customer)\n\t{\n\t\t\n\t\tfrappe.throw(\"Select Customer First\")\n\t}\n\telse\n\t{\n\n\t\tconsole.log(\"test1\");\n\n\tfrappe.call({\n\t\tmethod:\"warehouseapp.api.getLastPackageNumber\",\n\t\targs:{'customer':frm.doc.customer,'warehouse':frm.doc.warehouse},\n            callback(r) {\n\t\tconsole.log(r.message)\n\t\t\t\tif(r.message)\n\t\t\t\t{\n        \t\t\t\t    frm.set_value(\"package_no\",r.message);\n\t\t\t\t\t    refresh_filed(\"package_no\");\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\n\t\t\t\n});\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Packing", 
  "modified": "2019-02-02 12:35:11.131859", 
  "name": "Packing-Client", 
  "script": "frappe.ui.form.on(cur_frm.doctype, {\n            'onload_post_render': function(frm, cdt, cdn) {\n                frappe.ui.keys.on('enter', function(e) {\n                            if (!frm.doc.barcode == '') {\n\t\t\t\t\tcur_frm.reload_doc();\n\t\n\t\t\tfrappe.run_serially([\n\t\t\t() => {\n\n\t\t\t\tconsole.log(frm.doc.brand.charAt(0)+ frm.doc.barcode.substring(2).toLowerCase())\n\t\t\t\tfrappe.call({\n\t\t\t\t\t\"method\": \"frappe.client.set_value\",\n\t\t\t\t\t\"args\": {\n\t\t\t\t\t\t\"doctype\": \"Packing\",\n\t\t\t\t\t\t\"name\":frm.doc.name,\n\t\t\t\t\t\t\"fieldname\": {\n\t\t\t\t\t\t\t//You can update as many fields as you want.  \n\t\t\t\t\t\t\t\"item_code\": frm.doc.brand.charAt(0).toLowerCase()+ frm.doc.barcode.substring(2).toLowerCase()\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tcallback:function(r){\n\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t\t\t   \n\t\t\n\t\t\t\t},\n\t\t\t() => {\n\t\t\t\tconsole.log(\"2\")\n                              var doc =frm.doc\n                                var doctype = 'Packing';\n                                if (!frm.doc.print_format) {\n                                    frappe.throw(\"Please Select Print Format\")\n                                }\n                                frappe.call({\n                                        \"method\": \"warehouseapp.api.getItemCode\",\n                                        args: {\n                                            brand: frm.doc.brand,\n                                            barcode: frm.doc.barcode,\n                                            print_format: frm.doc.print_format\n                                        },\n                                        callback: function(r, rt) {\n                                            if (r.message) {\n                                                if (frm.doc.print_format == \"Small Barcode\") {\n                                                    var pf = '10x100'\n                                                    var w = window.open(frappe.urllib.get_full_url(\"/printview?\" +\n                                                        \"doctype=\" + \"Packing\" +\n                                                        \"&name=\" + frm.doc.name +\n                                                        \"&trigger_print=1\" +\n                                                        \"&format=\" + pf +\n                                                        \"&no_letterhead=0\" +\n                                                        (me.lang_code ? (\"&_lang=\" + me.lang_code) : \"\")));\n                                                    if (!w) {\n                                                        msgprint(__(\"Please enable pop-ups for printing.\"));\n                                                        return;\n                                                    }\n                                                    w.print();\n                                                } else if (frm.doc.print_format == \"Item Barcode\") {\n\t\t\t\t\t\t \tvar pf1 = '100x100'\n                                                    w = window.open(frappe.urllib.get_full_url(\"/printview?\" +\n                                                        \"doctype=\" + \"Packing\" +\n                                                        \"&name=\" +frm.doc.name+\n                                                        \"&trigger_print=1\" +\n                                                        \"&format=\" + pf1 +\n                                                        \"&no_letterhead=0\" +\n                                                        (me.lang_code ? (\"&_lang=\" + me.lang_code) : \"\")));\n                                                    if (!w) {\n                                                        msgprint(__(\"Please enable pop-ups for printing.\"));\n                                                        return;\n                                                    }\n                                                    w.print();\n                                                } else if (frm.doc.print_format == \"90x240\") {\n                                                    w = window.open(frappe.urllib.get_full_url(\"/printview?\" +\n                                                        \"doctype=\" + \"Packing\" +\n                                                        \"&name=\" +frm.doc.name+\n                                                        \"&trigger_print=1\" +\n                                                        \"&format=\" + frm.doc.print_format +\n                                                        \"&no_letterhead=0\" +\n                                                        (me.lang_code ? (\"&_lang=\" + me.lang_code) : \"\")));\n                                                    if (!w) {\n                                                        msgprint(__(\"Please enable pop-ups for printing.\"));\n                                                        return;\n                                                    }\n                                                    w.print();\n                                                } else {\n                                                    frappe.msgprint(\"Please Set item_code,brand,barcode in Item Barcode master\")\n                                                }\n                                            }\n                                        }\n                                })\n\n\n\t\t\t}\n\n\t\t\t])\n\n\n  \n                            }\n                        })\n                    }\n            });\n\n\nfrappe.ui.form.on(cur_frm.doctype, {\n\tbrand:function(r){\n\t\tcur_frm.reload_doc();\n\t\tcur_frm.save()\n\t},\n\ttarget_warehouse:function(r){\n\t\tcur_frm.reload_doc();\n\t\tcur_frm.save()\n\t\t\n\t},\nprint_format:function(r){\n\t\tcur_frm.reload_doc();\n\t\tcur_frm.save()\n\t\t\n\t}\t\n})", 
  "script_type": "Client"
 }
]